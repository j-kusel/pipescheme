<!DOCTYPE html>
<html>
    <head>
        <title>dashboard</title>
        <link rel="stylesheet" href="lib/leaflet/dist/leaflet.css" />
        <link rel="stylesheet" href="css/dashboard.css" />
        <script type="text/javascript" src="bower/angular/angular.js"></script>
        <script type="text/javascript" src="bower/angular-resource/angular-resource.js"></script>
    </head>
    <body ng-app="app" ng-controller="PipeController" ng-init="user = <%= JSON.stringify(user) %>">
        <div id="headbar">
            <div id="title">
                <h3>PIPESCHEME</h3>
            </div>
            <div id="controls">
                <span class="span-sel">state:</span>
                <div class="select-css">
                    <select class="selector"
                            ng-model="selected"
                            ng-options="state for state in states"
                            ng-change="changeState(selected)">
                    </select>
                </div>
                <input type="checkbox"
                    id="checker"
                    ng-model="fatal"
                    ng-change="changeState(selected)" />
                <label for="checker"><span></span></label>
                <span class="span-check">fatal?</span>
                <span class="span-sel">year:</span>
                <div class="select-css">
                    <select class="selector"
                            ng-model="year"
                            ng-options="year for year in years"
                            ng-change="changeState(selected)">
                    </select>
                </div>

            </div>
            <div id="options">
                <ul id="headmenu">
                    <div ng-if="user.firstName">
                        <li>welcome back {{ user.firstName }}!</li>
                        <li style="opacity: .2;">|</li>
                        <li><button onclick="window.location.href='/logout'">logout</button></li>
                    </div>
                    <div ng-if="!user.firstName">
                        <li><button ng-click='toggleSignin()'>signin</button></li>
                        <li style="opacity: .2;">|</li>
                        <li><button ng-click='toggleSignup()'>signup</button></li>
                    </div>
                    <li style="opacity: .2;">|</li>
                    <li><button ng-click='toggleAbout()'>about</button></li>
                </ul>
            </div>
        </div>
        <div>
            <ps-modal flashmsg="<%= flashmsg %>" show="modalShow">
                <ps-signin ng-if="formtype==='signin'"></ps-signin>
                <ps-signup ng-if="formtype==='signup'"></ps-signup>
                <div ng-if="formtype==='about'" ng-include="'templates/about.html'"></div>
            </ps-modal>
        </div>
        <div id="main">
            <div id="map" style="width: 100%; height: 350px; z-index: 1;"></div>
            <ul class="info">
                <li>{{ focus.county }} CO.</li>
                <li style="opacity: .2;">|</li>
                <li>{{ focus.address }}</li>
            </ul>
            <h1 id="city">{{ focus.city }}, {{ focus.state }}</h1>
            <ul class="info">
                <li>{{ focus.datetime | date : "MMM dd, y" }}</li>
                <li style="opacity: .2;">|</li>
                <li>rpt. #{{ focus.report }}</li>
            </ul>
            <p id="narrative">{{ focus.narrative }}</p>
            <p>injuries: {{ focus.injuries }}</p>
            <p>fatalities: {{ focus.fatalities }}</p>
            <p>operator name?: {{ focus.operator }}</p>
            <p>operator type?: {{ focus.operatorType }}</p>
            <p>investigation?: {{ focus.investigation }}</p>
            <p>cause?: {{ focus.cause }}</p>
            <p>cause details?: {{ focus.causeDetails }}</p>
            <p>work?: {{ focus.work }}</p>
            <p>root cause?: {{ focus.rootCause }}</p>
            <p>root cause other?: {{ focus.rootCauseOther }}</p>
            <p>{{ focus.year }}</p>

        </div>

        <!-- Leaflet.js -->
        <script src="lib/leaflet/dist/leaflet.js"></script>

        <!-- application -->
        <script src="js/app.js"></script>

        <!-- services -->
        <script src="js/services/pipeScheme.service.js"></script>
        <script src="js/services/geo.service.js"></script>

        <!-- controllers -->
        <script src="js/controllers/pipeScheme.js"></script>
        <!-- <script src="js/controllers/users.client.controller.js"></script> -->

        <!-- directives -->
        <script src="js/directives/psModal.client.directive.js"></script>
        <script src="js/directives/loginForms.client.directive.js"></script>

    </body>
</html>
